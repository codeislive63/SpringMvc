<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6">
<head>
    <meta charset="UTF-8">
    <title>Подтверждение бронирования • Railway Booker</title>
    <link rel="stylesheet" th:href="@{/css/app.css}">
</head>
<body class="app-bg">

<header th:replace="~{fragments/topbar :: topbar}"></header>

<main class="page">
    <section class="welcome">
        <h1>Бронирование выполнено</h1>
        <p>Ниже список ваших забронированных билетов. Вы можете перейти к оплате каждого билета или вернуться к списку своих бронирований.</p>
    </section>

    <section class="cards-grid">
        <article class="card" th:each="t : ${tickets}">
            <p>Рейс: <b th:text="${t.trip.route.getName()}"></b></p>
            <p>Место: <b th:text="${t.seatNumber}"></b></p>
            <p>Цена: <b th:text="${t.price}"></b></p>
            <p>Статус: <b th:text="${t.status.label}"></b></p>
            <div th:if="${t.passengerDetails != null}" class="notice">
                <p><b>Пассажир:</b> <span th:text="${t.passengerDetails.fullName}">Имя</span></p>
                <p><b>Документ:</b> <span th:text="${t.passengerDetails.documentNumber}">Документ</span></p>
                <p th:if="${t.passengerDetails.benefitType}">Льгота: <span th:text="${t.passengerDetails.benefitType}"></span></p>
                <p th:if="${t.passengerDetails.childTicket}">Детский билет (скидка применена)</p>
                <p th:if="${t.passengerDetails.loyaltyNumber}">Бонусная карта: <span th:text="${t.passengerDetails.loyaltyNumber}"></span></p>
            </div>
            <div th:if="${t.additionalServices != null}" class="notice">
                <p><b>Услуги:</b></p>
                <ul class="list-compact">
                    <li th:if="${t.additionalServices.mealOption != null and !t.additionalServices.mealOption.isEmpty()}"
                        th:text="'Питание: ' + ${t.additionalServices.mealOption}"></li>
                    <li th:if="${t.additionalServices.insuranceIncluded}">Страхование</li>
                    <li th:if="${t.additionalServices.transferIncluded}">Трансфер / такси</li>
                    <li th:if="${t.additionalServices.baggageSelected}">Дополнительный багаж</li>
                    <li th:if="${t.additionalServices.petTravel}">Путешествие с животными</li>
                </ul>
            </div>
            <form th:action="@{/booking/pay/{id}(id=${t.id})}" method="post">
                <button class="btn primary" type="submit">Оплатить</button>
            </form>
        </article>

        <div class="actions mt-16">
            <a class="btn secondary" th:href="@{/booking/my}">Мои билеты</a>
            <a class="btn" th:href="@{/routes/search}">Вернуться к поиску</a>
        </div>
    </section>
</main>

</body>
</html>
